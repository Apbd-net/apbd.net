<!DOCTYPE html><html lang="en" dir="ltr"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>APBD.net: Provide Food Info</title>

    <meta name="description" content="Allows adding different foods to APBD.net's Food List directly via the website. Try it out - Help a cause!">

    <link rel="stylesheet" href="/css/foods/main.css">
    <link rel="stylesheet" href="/css/foods/dropdown.css">
    <link rel="stylesheet" href="/css/foods/contribute.css">

</head>

<!-- Google tag (gtag.js) -->
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-Y5TJK47MS3"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());

    gtag('config', 'G-Y5TJK47MS3');
</script>


<body>
    <script>
        const touch = matchMedia('(hover: none)').matches
        console.log(touch);

        if (touch) {
            let prev = window.document.body;
            window.addEventListener("touchend", function (e) {
                if (e.target.onclick) e.target.onclick();
                if (prev !== e.target) prev.classList.remove("hover");
                e.target.classList.toggle("hover");
                prev = e.target;
                console.log(e.target);
            }, { passive: false });
        }
    </script>
    <header>
        <div class="logo">
            <img src="/favicon.ico" alt="Website logo">
            <div class="column">
                <a class="title" href="https://apbd.net">APBD.net</a>
                <a class="sub" href="/">Allowed Foods List</a>
            </div>

        </div>
        <nav class="header-menu">
            <div class="dropdown">
                <a id="about" href="#">About</a>
                <div class="dropdown-content">
                    <a target="_blank" href="https://github.com/ShaharMS/APBD-FoodList/blob/main/README.md">Website</a>
                    <a target="_blank" href="https://rarediseases.org/rare-diseases/adult-polyglucosan-body-disease/">APBD
                        <span>‚Üó</span></a>
                    <a href="../about/database.html">Food Database</a>
                </div>
            </div>
            <div class="dropdown">
                <a id="contribute" href="#">Contribute</a>
                <div class="dropdown-content">
                    <a href="../contribute/request.html">Request data</a>
                    <a href="../contribute/provide.html">Provide data</a>
                    <a href="../contribute/leaderboards.html">Leaderboards</a>
                </div>
            </div>

            <div class="dropdown">
                <a id="contact" href="#">Language</a>
                <div class="dropdown-content">
                    <a onclick="window.location.href = window.location.href.replace(new RegExp('he|en'), 'en')" href="#">English</a>
                    <a onclick="window.location.href = window.location.href.replace(new RegExp('he|en'), 'he')" href="#">Hebrew</a>
                </div>
            </div>
        </nav>
    </header>

    <div class="container">
        <blockquote>This page exists to help you and other people, by expanding the list of documented foods. Don't hesitate to choose "I dont know" or "I'm not sure". I've got your back :)</blockquote>

        <form id="provide-form">
            <table id="provide-table">
                <tbody><tr>
                    <th>
                        <help>Your first and last name. Used to add this contribution to the leaderboards, under your name. Contribute enough, and maybe one day you'll get to 1st place üòÅ</help>
                        <span>Name</span>
                    </th>
                    <td>
                        <input id="name" placeholder="First and last name...">
                        <div class="button-row">
                            <button id="n-np" type="button">I'd rather not provide</button>
                        </div>
                    </td>
                </tr>
                <tr>

                    <th>
                        <help>The Food's name. More useful to leave a concise name here, and if a company is involved, mention it after the fact.</help>
                        <span>Food name (english)</span>
                    </th>
                    <td>
                        <input id="food-name-english" placeholder="Food name...">
                        <div class="button-row">
                            <button id="fn-ns" type="button">I'm not sure</button>
                            <button id="fn-dk" type="button">I don't know</button>
                        </div>
                    </td>
                </tr>
                <tr>
                    <th>
                        <help>For Translation purposes, It is a good idea to add the name in Hebrew. (makes my job a little easier üôÉ)</help>
                        <span>Food name (hebrew)</span>
                    </th>
                    <td>
                        <input id="food-name-hebrew" placeholder="◊©◊ù ◊î◊û◊ê◊õ◊ú...">
                        <div class="button-row">
                            <button id="t-ns" type="button">I'm not sure</button>
                            <button id="t-dk" type="button">I don't know</button>
                        </div>
                    </td>
                </tr>
                <tr>
                    <th>
                        <help>Change this value if the food you'd like to provide has a specific weight to it (for example, a Big Mac weighs 220 grams)</help>
                        <span>Optional: Food's Weight</span>
                    </th>
                    <td>
                        <input type="number" id="food-weight" placeholder="100" value="100" min="0"> 
                        <div class="button-row">
                            <button type="button" onclick="document.getElementById('food-weight').value = 100; this.classList.toggle('selected');">Reset to 100g</button>
                        </div>
                    </td>
                </tr>
                <tr>
                    <th>
                        <help>If the specific food you're requesting is produced by a specific company, mention it here, This allows me to tag the item with the company and it's logo.</help>
                        <span>Optional: Food's Company</span>
                    </th>
                    <td>
                        <input id="company" list="companies" placeholder="Company Name...">
                        <datalist id="companies"></datalist>
                        <div class="button-row">
                            <button id="co-ns" type="button">I'm not sure</button>
                            <button id="co-dk" type="button">I don't know</button>
                        </div>
                    </td>
                </tr>
                <tr>
                    <th>
                        <help>Each food has a glycemic index, ranging from 0 to 100. A higher value spikes blood sugar higher and more rapidly.</help>
                        <span>Glycemic Index</span>
                    </th>
                    <td>
                        <input id="glycemic-index" type="number" min="0" max="100" placeholder="Between 0 and 100">
                        <div class="button-row">
                            <button id="gi-ns" type="button">I'm not sure</button>
                            <button id="gi-dk" type="button">I don't know</button>
                        </div>
                    </td>
                </tr>
                <tr>
                    <th>
                        <help>Glycemic Load is defined by the glycemic index, divided by 100, then multiplied by the amount of carbs the food contains (in grams). A higher value spikes blood sugar higher and more rapidly</help>
                        <span>Glycemic Load (Per 100g)</span>
                    </th>
                    <td>
                        <input id="glycemic-load" type="number" min="0" placeholder="Glycemic Load">
                        <div class="button-row">
                            <button id="gl-ns" type="button">I'm not sure</button>
                            <button id="gl-dk" type="button">I don't know</button>
                        </div>
                    </td>
                </tr>
                <tr>
                    <th>
                        <help>Sugar is one of the three types of carbohydrates. aside from it, there are also starches &amp; fibers. Fibers are 'ok' carbs, while starches &amp; sugars are 'bad' carbs.</help>
                        <span>Sugar (Per 100g)</span>
                    </th>
                    <td>
                        <input id="sugar" type="number" min="0" placeholder="Sugar (grams)">
                        <div class="button-row">
                            <button id="s-ns" type="button">I'm not sure</button>
                            <button id="s-dk" type="button">I don't know</button>
                        </div>
                    </td>
                </tr>
                <tr>
                    <th>
                        <help>Starch is one of the three types of carbohydrates. aside from it, there are also fibers. Fibers are 'ok' carbs, while starches &amp; sugars are 'bad' carbs.</help>
                        <span>Starch (Per 100g)</span>
                    </th>
                    <td>
                        <input id="starch" type="number" min="0" placeholder="Starch (grams)">
                        <div class="button-row">
                            <button id="st-ns" type="button">I'm not sure</button>
                            <button id="st-dk" type="button">I don't know</button>
                        </div>
                    </td>
                </tr>
                <tr>
                    <th>
                        <help>Fibers are the only healthy carbohydrates. Meals containing large amounts of fiber are much healthier, but they may make you 'visit' the bathroom more often :)</help>
                        <span>Fiber (Per 100g)</span>
                    </th>
                    <td>
                        <input id="fiber" type="number" min="0" placeholder="Fiber (grams)">
                        <div class="button-row">
                            <button id="f-ns" type="button">I'm not sure</button>
                            <button id="f-dk" type="button">I don't know</button>
                        </div>
                    </td>
                </tr>
                <tr>
                    <th>
                        <help>Almost every single food contains carbohydrates. Our body uses them to generate energy</help>
                        <span>Carbs (Per 100g)</span>
                    </th>
                    <td>
                        <input id="carbs" type="number" min="0" placeholder="Carbs (grams)">
                        <div class="button-row">
                            <button id="c-ns" type="button">I'm not sure</button>
                            <button id="c-dk" type="button">I don't know</button>
                        </div>
                    </td>
                </tr>
            </tbody></table>
        </form>

        <div class="row">
            <button type="submit" id="submit">Submit</button>
        </div>
        <h3 id="submition-output"></h3>


        <script>
            String.prototype.attemptedXSS = function () {
                return /[<>]/.test(this);
            }


            let submit = document.getElementById("submit");
            let output = document.getElementById("submition-output");

            submit.onclick = () => {

                let notice = confirm("Are you sure you want to submit?");
                if (!notice) return;

                submit.textContent = "Submitting...";

                output.innerHTML = "Grabbing Data From Text Fields...";

                let name = document.getElementById("name").value;
                let name__RatherNotProvide = document.getElementById("n-np").classList.contains("selected");
                if (name.length === 0 && !name__RatherNotProvide) {
                    output.innerHTML = "Please provide a name, or select 'I'd rather not provide'.";
                    submit.textContent = "Submit";
                    return;
                }

                let foodEn = document.getElementById("food-name-english").value;
                let foodEn_NotSure = document.getElementById("fn-ns").classList.contains("selected");
                let foodEn_DontKnow = document.getElementById("fn-dk").classList.contains("selected");
                let foodEn_Sureness = foodEn_DontKnow ? 0 : foodEn_NotSure ? 1 : 2;

                let foodHe = document.getElementById("food-name-hebrew").value;
                let foodHe_NotSure = document.getElementById("t-ns").classList.contains("selected");
                let foodHe_DontKnowAny = document.getElementById("t-dk").classList.contains("selected");
                let foodHe_Sureness = foodHe_DontKnowAny ? 0 : foodHe_NotSure ? 1 : 2;

                let foodCompany = document.getElementById("company").value;
                console.log(foodCompany, foodCompany.length);
                
                let foodCompanyObject = foodCompany.length === 0 ? null : localCompanyNameToObject(foodCompany, window.TABLE_JSON_DATA);

                let foodWeight = document.getElementById("food-weight").value;

                let glycemicIndex = document.getElementById("glycemic-index").value;
                let glycemicIndex_NotSure = document.getElementById("gi-ns").classList.contains("selected");
                let glycemicIndex_DontKnow = document.getElementById("gi-dk").classList.contains("selected");
                glycemicIndex = glycemicIndex_DontKnow ? -1 : glycemicIndex
                let glycemicIndex_Metadata = glycemicIndex_NotSure ? "inaccurate" : "";

                let glycemicLoad = document.getElementById("glycemic-load").value;
                let glycemicLoad_NotSure = document.getElementById("gl-ns").classList.contains("selected");
                let glycemicLoad_DontKnow = document.getElementById("gl-dk").classList.contains("selected");
                glycemicLoad = glycemicLoad_DontKnow ? -1 : glycemicLoad;
                let glycemicLoad_Metadata = glycemicLoad_NotSure ? "inaccurate" : "";

                let sugar = document.getElementById("sugar").value;
                let sugar_NotSure = document.getElementById("s-ns").classList.contains("selected");
                let sugar_DontKnow = document.getElementById("s-dk").classList.contains("selected");
                sugar = sugar_DontKnow ? -1 : sugar;
                let sugar_Metadata = sugar_NotSure ? "inaccurate" : "";

                let starch = document.getElementById("starch").value;
                let starch_NotSure = document.getElementById("st-ns").classList.contains("selected");
                let starch_DontKnow = document.getElementById("st-dk").classList.contains("selected");
                starch = starch_DontKnow ? -1 : starch;
                let starch_Metadata = starch_NotSure ? "inaccurate" : "";

                let fiber = document.getElementById("fiber").value;
                let fiber_NotSure = document.getElementById("f-ns").classList.contains("selected");
                let fiber_DontKnow = document.getElementById("f-dk").classList.contains("selected");
                fiber = fiber_DontKnow ? -1 : fiber;
                let fiber_Metadata = fiber_NotSure ? "inaccurate" : "";

                let carbs = document.getElementById("carbs").value;
                let carbs_NotSure = document.getElementById("c-ns").classList.contains("selected");
                let carbs_DontKnow = document.getElementById("c-dk").classList.contains("selected");
                carbs = carbs_DontKnow ? -1 : carbs;
                let carbs_Metadata = carbs_NotSure ? "inaccurate" : "";

                if (document.getElementById("food-name-english").classList.contains("already-exists") || document.getElementById("food-name-hebrew").classList.contains("already-exists")) {
                    output.innerHTML = "Food already exists in the food list.";
                    submit.textContent = "Submit";
                    return;
                }

                output.innerHTML = "Testing For Attempted XSS Attacks...";

                if (name.attemptedXSS() || foodEn.attemptedXSS() || glycemicIndex.attemptedXSS() || glycemicLoad.attemptedXSS() || sugar.attemptedXSS() || carbs.attemptedXSS() || foodHe.attemptedXSS()) {
                    output.innerHTML = "Nice try üòâ";
                    submit.textContent = "Submit";
                    return;
                }

                output.innerHTML = "Building & Sending Submission Packet...";

                provideUsingDetails(name, [foodEn, foodEn_Sureness], [foodHe, foodHe_Sureness], foodWeight, foodCompanyObject, {value: glycemicIndex, metadata: glycemicIndex_Metadata}, {value: glycemicLoad, metadata: glycemicLoad_Metadata}, {value: sugar, metadata: sugar_Metadata}, {value: starch, metadata: starch_Metadata}, {value: fiber, metadata: fiber_Metadata}, {value: carbs, metadata: carbs_Metadata})
                    .then(response => {
                        output.innerHTML = response;
                        submit.textContent = "Submit";
                        // document.getElementById("food-name-english").value = "";
                        // document.getElementById("food-name-hebrew").value = "";
                        // document.getElementById("food-weight").value = "";
                        // document.getElementById("glycemic-index").value = "";
                        // document.getElementById("glycemic-load").value = "";
                        // document.getElementById("sugar").value = "";
                        // document.getElementById("carbs").value = "";
                        // document.getElementById("company").value = "";
                    })

            }   
        </script>

    </div>

    <script src="/js/foods/help-marks.js"></script>
    <script src="/js/foods/choice-buttons.js"></script>
    <script src="/js/foods/food-name-validator.js"></script>
    <script src="/js/foods/contribute.js"></script>



</body></html>