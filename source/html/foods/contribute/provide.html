<!DOCTYPE html>
<html lang-en="en" lang-he="he" dir-he="rtl" dir-en="ltr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title en="APBD.net: Provide Food Info" he="APBD.net: ספק מידע על מאכל"></title>

    <meta name="description"
        content-en="Allows adding different foods to APBD.net's Food List directly via the website. Try it out - Help a cause!"
        content-he="-כאן אפשר להוסיף מאכלים נוספים לרשימת המאכלים שלנו בAPBD.net. נסה אותי - עשה טוב!&rlm;">

    <link rel="stylesheet" href="/css/foods/main.css">
    <link rel="stylesheet" href="/css/foods/dropdown.css">
    <link rel="stylesheet" href="/css/foods/contribute.css">

</head>

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-VPXMF38X8C"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());

    gtag('config', 'G-VPXMF38X8C');
</script>

<body>
    <script>
        const touch = matchMedia('(hover: none)').matches
        console.log(touch);

        if (touch) {
            let prev = window.document.body;
            window.addEventListener("touchend", function (e) {
                if (e.target.onclick) e.target.onclick();
                if (prev !== e.target) prev.classList.remove("hover");
                e.target.classList.toggle("hover");
                prev = e.target;
                console.log(e.target);
            }, { passive: false });
        }
    </script>
    <header>
        <div class="logo">
            <img src="/favicon.ico" alt="Website logo">
            <div class="column">
                <a class="title" href="https://apbd.net">APBD.net</a>
                <a class="sub" href="/"
                    en="Allowed Foods List" he="רשימת מאכלים מותרים">
                    Allowed Foods List
                </a>
            </div>

        </div>
        <nav class="header-menu">
            <div class="dropdown">
                <a id="about" href="#" en="About" he="אודות">About</a>
                <div class="dropdown-content">
                    <a target="_blank" href="https://github.com/ShaharMS/APBD-FoodList/blob/main/README.md" en="Website"
                        he="אתר">Website<span>&UpperRightArrow;</span></a>
                    <a target="_blank"
                        href="https://rarediseases.org/rare-diseases/adult-polyglucosan-body-disease/">APBD
                        <span>&UpperRightArrow;</span></a>
                    <a href="../about/database.html" en="Food Database" he="מסד הנתונים">Food Database</a>
                </div>
            </div>
            <div class="dropdown">
                <a id="contribute" href="#" en="Contribute" he="תרום תוכן">Contribute</a>
                <div class="dropdown-content">
                    <a href="../contribute/request.html" en="Request data" he="בקשת נתונים">Request data</a>
                    <a href="../contribute/provide.html" en="Provide data" he="סיפוק נתונים">Provide data</a>
                    <a href="../contribute/leaderboards.html" en="Leaderboards" he="תורמים מובילים">Leaderboards</a>
                </div>
            </div>

            <div class="dropdown">
                <a id="contact" href="#" en="Language" he="שפה">Language</a>
                <div class="dropdown-content">
                    <a onclick="window.location.href = window.location.href.replace(new RegExp('he|en'), 'en')" href="#"
                        en="English" he="אנגלית">English</a>
                    <a onclick="window.location.href = window.location.href.replace(new RegExp('he|en'), 'he')" href="#"
                        en="Hebrew" he="עברית">Hebrew</a>
                </div>
            </div>
        </nav>
    </header>

    <div class="container">
        <blockquote
            en="This page exists to help you and other people, by expanding the list of documented foods. Don't hesitate to choose &quot;I dont know&quot; or &quot;I'm not sure&quot;. I've got your back :)"
            he="העמוד הזה קיים על מנת לאפשר לך ולאנשים אחרים לעזור אחד לשני, ע&quot;י הרחבה של רשימת המאכלים המתועדים. אין צורך לחשוש אם לא בטוחים/יודעים מידע מסוים - אני על זה :)&rlm;">
        </blockquote>

        <form id="provide-form">
            <table id="provide-table">
                <tr>
                    <th>
                        <help
                            en="Your first and last name. Used to add this contribution to the leaderboards, under your name. Contribute enough, and maybe one day you'll get to 1st place 😁"
                            he="השם הפרטי + משפחה שלך. אם ניתן, ישמש בתור מזהה בלוח ההישגים, שתחתיו תווסף תרומת התוכן. תרום מספיק תוכן, ואולי תגיע למקום הראשון 😁&rlm;">
                        </help>
                        <span en="Name" he="שם">Name</span>
                    </th>
                    <td>
                        <input id="name" placeholder-en="First and last name..."
                            placeholder-he="שם פרטי ושם משפחה...">
                        <div class="button-row">
                            <button id="n-np" type="button" en="I'd rather not provide" he="מעדיף שלא למסור">I'd
                                rather not provide</button>
                        </div>
                    </td>
                </tr>
                <tr>

                    <th>
                        <help
                            en="The Food's name. More useful to leave a concise name here, and if a company is involved, mention it after the fact."
                            he="שם המאכל אותו אתה רוצה להוסיף. עדיף להביא שם ממוקד יותר אם אפשר (כמובן מבלי להשמיט מידע). אם מעורבת חברה מסוימת ביצור האוכל, ניתן להזכיר זאת בשדה נפרד.&rlm;">
                        </help>
                        <span en="Food name (english)" he="שם המאכל (אנגלית)">">Food name (english)</span>
                    </th>
                    <td>
                        <input id="food-name-english" placeholder="Food name...">
                        <div class="button-row">
                            <button id="fn-ns" type="button" en="I'm not sure" he="אני לא בטוח">I'm not
                                sure</button>
                            <button id="fn-dk" type="button" en="I don't know" he="אני לא יודע">I don't
                                know</button>
                        </div>
                    </td>
                </tr>
                <tr>
                    <th>
                        <help
                            en="For Translation purposes, It is a good idea to add the name in Hebrew. (makes my job a little easier 🙃)"
                            he="למטרות תרגום, מומלץ לתת גם את שם המאכל בעברית (הופך לי את העבודה לקלה יותר 🙃)&rlm;">
                        </help>
                        <span en="Food name (hebrew)" he="שם המאכל (עברית)">">Food name (hebrew)</span>
                    </th>
                    <td>
                        <input id="food-name-hebrew" placeholder="שם המאכל...">
                        <div class="button-row">
                            <button id="t-ns" type="button" en="I'm not sure" he="אני לא בטוח">I'm not
                                sure</button>
                            <button id="t-dk" type="button" en="I don't know" he="אני לא יודע">>I don't
                                know</button>
                        </div>
                    </td>
                </tr>
                <tr>
                    <th>
                        <help
                            en="Change this value if the food you'd like to provide has a specific weight to it (for example, a Big Mac weighs 220 grams)"
                            he="אפשר לשנות את הערך הזה אם למאכל שמספקים יש משקל ספציפי (לדוגמה: הביג מק של מקדונלדס שוקל 220 גרם)."
                        ></help>
                        <span en="Optional: Food's Weight" he="אופציונאלי: משקל המאכל">Optional: Food's Weight"></span>
                    </th>
                    <td>
                        <input type="number" id="food-weight" placeholder="100" value="100" min="0"> 
                        <div class="button-row">
                            <button type="button" onclick="document.getElementById('food-weight').value = 100; this.classList.toggle('selected');"
                                en="Reset to 100g" he="איפוס ל-100 גרם"></button>
                        </div>
                    </td>
                </tr>
                <tr>
                    <th>
                        <help
                            en="If the specific food you're requesting is produced by a specific company, mention it here, This allows me to tag the item with the company and it's logo."
                            he="אם המוצר הספציפי אותו אתה מבקש מיוצר ע&quot;י חברה מסוימת, תזכיר את שמה כאן. זה נותן לי להצמיד את שם ולוגו החברה למוצר באתר עצמו.&rlm;">
                        </help>
                        <span en="Optional: Food's Company" he="אופציונאלי: שם החברה">Optional: Food's
                            Company</span>
                    </th>
                    <td>
                        <input id="company" placeholder-en="Company Name..." placeholder-he="שם החברה..."
                            list="companies">
                        <datalist id="companies"></datalist>
                        <div class="button-row">
                            <button id="co-ns" type="button" en="I'm not sure" he="אני לא בטוח">I'm not
                                sure</button>
                            <button id="co-dk" type="button" en="I don't know" he="אני לא יודע">I don't
                                know</button>
                        </div>
                    </td>
                </tr>
                <tr>
                    <th>
                        <help 
                            en="Each food has a glycemic index, ranging from 0 to 100. A higher value spikes blood sugar higher and more rapidly."
                            he="כל אוכל נמצא במקום כלשהו על מדד הערך הגליקמי. ערכים גבוהים 'מקפיצים' את רמת הסוכר בדם לרמה גבוהה, ובמהירות.&rlm;">
                        </help>
                        <span en="Glycemic Index" he="ערך גליקמי"></span>
                    </th>
                    <td>
                        <input id="glycemic-index" type="number" placeholder-en="Between 0 and 100" placeholder-he="בין 0 ל-100" min="0" max="100">
                        <div class="button-row">
                            <button id="gi-ns" type="button" en="I'm not sure" he="אני לא בטוח">I'm not sure</button>
                            <button id="gi-dk" type="button" en="I don't know" he="אני לא יודע">I don't know</button>
                        </div>
                    </td>
                </tr>
                <tr>
                    <th>
                        <help
                            en="Glycemic Load is defined by the glycemic index, divided by 100, then multiplied by the amount of carbs the food contains (in grams). A higher value spikes blood sugar higher and more rapidly"
                            he="עומס גליקמי מחושב באמצעות חילוק הערך הגליקמי ב-100, והכפלת התוצאה בכמות הפחממות שבאוכל, בגרמים. ערכים גבוהים יותר 'מקפיצים' את רמת הסוכר בדם לרמה גבוהה, ובמהירות גבוהה יותר.&rlm;">
                        </help>
                        <span en="Glycemic Load (Per 100g)" he="עומס גליקמי (ל-100 גרם)">{{Glycemic Load}} ({{Per 100g}})</span>
                    </th>
                    <td>
                        <input id="glycemic-load" type="number" placeholder-en="Glycemic Load" placeholder-he="עומס גליקמי" min="0">
                        <div class="button-row">
                            <button id="gl-ns" type="button" en="I'm not sure" he="אני לא בטוח">I'm not sure</button>
                            <button id="gl-dk" type="button" en="I don't know" he="אני לא יודע">I don't know</button>
                        </div>
                    </td>
                </tr>
                <tr>
                    <th>
                        <help
                            en="Sugar is one of the three types of carbohydrates. aside from it, there are also starches & fibers. Fibers are 'ok' carbs, while starches & sugars are 'bad' carbs."
                            he="סוכר הוא אחד משלושת סוגי הפחמימות: סיבים, סוכר, ועמילן. סיבים הן פחמימה 'טובה', בעוד שעמילן וסוכר הן פחמימות 'רעות'.&rlm;">
                        </help>
                        <span en="Sugar (Per 100g)" he="סוכר (ל-100 גרם)"></span>
                    </th>
                    <td>
                        <input id="sugar" type="number" placeholder-en="Sugar (grams)" placeholder-he="סוכר (גרם)" min="0">
                        <div class="button-row">
                            <button id="s-ns" type="button" en="I'm not sure" he="אני לא בטוח">I'm not sure</button>
                            <button id="s-dk" type="button" en="I don't know" he="אני לא יודע">I don't know</button>
                        </div>
                    </td>
                </tr>
                <tr>
                    <th>
                        <help
                            en="Starch is one of the three types of carbohydrates. aside from it, there are also fibers. Fibers are 'ok' carbs, while starches & sugars are 'bad' carbs."
                            he="עמילן הוא אחד משלושת סוגי הפחמימות. סיבים תזונתיים הם הפחמימות הטובות, בעוד שעמילן וסוכר הן הפחמימות ה'רעות'."
                        ></help>
                        <span en="Starch (Per 100g)" he="עמילן (ל-100 גרם)"></span>
                    </th>
                    <td>
                        <input id="starch" type="number" placeholder-en="Starch (grams)" placeholder-he="עמילן (גרם)" min="0">
                        <div class="button-row">
                            <button id="st-ns" type="button" en="I'm not sure" he="אני לא בטוח">I'm not sure</button>
                            <button id="st-dk" type="button" en="I don't know" he="אני לא יודע">I don't know</button>
                        </div>
                    </td>
                </tr>
                <tr>
                    <th>
                        <help
                            en="Fibers are the only healthy carbohydrates. Meals containing large amounts of fiber are much healthier, but they may make you 'visit' the bathroom more often :)"
                            he="סיבים תזונתיים הם סוג הפחמימות הטוב היחיד. ארוחות מרובות בסיבים תזונתיים יותר בריאות, אך יכולות לגרום ל'ביקורים' תכופים בשירותים' :)"
                        ></help>
                        <span en="Fiber (Per 100g)" he="סיבים תזונתיים (ל-100 גרם)"></span>
                    </th>
                    <td>
                        <input id="fiber" type="number" placeholder-en="Fiber (grams)" placeholder-he="סיבים תזונתיים (גרם)" min="0">
                        <div class="button-row">
                            <button id="f-ns" type="button" en="I'm not sure" he="אני לא בטוח">I'm not sure</button>
                            <button id="f-dk" type="button" en="I don't know" he="אני לא יודע">I don't know</button>
                        </div>
                    </td>
                </tr>
                <tr>
                    <th>
                        <help
                            en="Almost every single food contains carbohydrates. Our body uses them to generate energy"
                            he="רוב המאכלים מכילים כמות מסוימת של פחמימות. הגוף שלנו משתמש בהם על מנת לייצר אנרגיה">
                        </help>
                        <span en="Carbs (Per 100g)" he="פחמימות (ל-100 גרם)"></span>
                    </th>
                    <td>
                        <input id="carbs" type="number" placeholder-en="Carbs (grams)" placeholder-he="פחמימות (גרם)" min="0">
                        <div class="button-row">
                            <button id="c-ns" type="button" en="I'm not sure" he="אני לא בטוח">I'm not sure</button>
                            <button id="c-dk" type="button" en="I don't know" he="אני לא יודע">I don't know</button>
                        </div>
                    </td>
                </tr>
            </table>
        </form>

        <div class="row">
            <button type="submit" id="submit" en="Submit" he="שלח"></button>
        </div>
        <h3 id="submition-output"></h3>


        <script>
            String.prototype.attemptedXSS = function () {
                return /[<>]/.test(this);
            }


            let submit = document.getElementById("submit");
            let output = document.getElementById("submition-output");

            submit.onclick = () => {

                let notice = confirm("Are you sure you want to submit?");
                if (!notice) return;

                submit.textContent = "Submitting...";

                output.innerHTML = "Grabbing Data From Text Fields...";

                let name = document.getElementById("name").value;
                let name__RatherNotProvide = document.getElementById("n-np").classList.contains("selected");
                if (name.length === 0 && !name__RatherNotProvide) {
                    output.innerHTML = "Please provide a name, or select 'I'd rather not provide'.";
                    submit.textContent = "Submit";
                    return;
                }

                let foodEn = document.getElementById("food-name-english").value;
                let foodEn_NotSure = document.getElementById("fn-ns").classList.contains("selected");
                let foodEn_DontKnow = document.getElementById("fn-dk").classList.contains("selected");
                let foodEn_Sureness = foodEn_DontKnow ? 0 : foodEn_NotSure ? 1 : 2;

                let foodHe = document.getElementById("food-name-hebrew").value;
                let foodHe_NotSure = document.getElementById("t-ns").classList.contains("selected");
                let foodHe_DontKnowAny = document.getElementById("t-dk").classList.contains("selected");
                let foodHe_Sureness = foodHe_DontKnowAny ? 0 : foodHe_NotSure ? 1 : 2;

                let foodCompany = document.getElementById("company").value;
                console.log(foodCompany, foodCompany.length);
                
                let foodCompanyObject = foodCompany.length === 0 ? null : localCompanyNameToObject(foodCompany, window.TABLE_JSON_DATA);

                let foodWeight = document.getElementById("food-weight").value;

                let glycemicIndex = document.getElementById("glycemic-index").value;
                let glycemicIndex_NotSure = document.getElementById("gi-ns").classList.contains("selected");
                let glycemicIndex_DontKnow = document.getElementById("gi-dk").classList.contains("selected");
                glycemicIndex = glycemicIndex_DontKnow ? -1 : glycemicIndex
                let glycemicIndex_Metadata = glycemicIndex_NotSure ? "inaccurate" : "";

                let glycemicLoad = document.getElementById("glycemic-load").value;
                let glycemicLoad_NotSure = document.getElementById("gl-ns").classList.contains("selected");
                let glycemicLoad_DontKnow = document.getElementById("gl-dk").classList.contains("selected");
                glycemicLoad = glycemicLoad_DontKnow ? -1 : glycemicLoad;
                let glycemicLoad_Metadata = glycemicLoad_NotSure ? "inaccurate" : "";

                let sugar = document.getElementById("sugar").value;
                let sugar_NotSure = document.getElementById("s-ns").classList.contains("selected");
                let sugar_DontKnow = document.getElementById("s-dk").classList.contains("selected");
                sugar = sugar_DontKnow ? -1 : sugar;
                let sugar_Metadata = sugar_NotSure ? "inaccurate" : "";

                let starch = document.getElementById("starch").value;
                let starch_NotSure = document.getElementById("st-ns").classList.contains("selected");
                let starch_DontKnow = document.getElementById("st-dk").classList.contains("selected");
                starch = starch_DontKnow ? -1 : starch;
                let starch_Metadata = starch_NotSure ? "inaccurate" : "";

                let fiber = document.getElementById("fiber").value;
                let fiber_NotSure = document.getElementById("f-ns").classList.contains("selected");
                let fiber_DontKnow = document.getElementById("f-dk").classList.contains("selected");
                fiber = fiber_DontKnow ? -1 : fiber;
                let fiber_Metadata = fiber_NotSure ? "inaccurate" : "";

                let carbs = document.getElementById("carbs").value;
                let carbs_NotSure = document.getElementById("c-ns").classList.contains("selected");
                let carbs_DontKnow = document.getElementById("c-dk").classList.contains("selected");
                carbs = carbs_DontKnow ? -1 : carbs;
                let carbs_Metadata = carbs_NotSure ? "inaccurate" : "";

                if (document.getElementById("food-name-english").classList.contains("already-exists") || document.getElementById("food-name-hebrew").classList.contains("already-exists")) {
                    output.innerHTML = "Food already exists in the food list.";
                    submit.textContent = "Submit";
                    return;
                }

                output.innerHTML = "Testing For Attempted XSS Attacks...";

                if (name.attemptedXSS() || foodEn.attemptedXSS() || glycemicIndex.attemptedXSS() || glycemicLoad.attemptedXSS() || sugar.attemptedXSS() || carbs.attemptedXSS() || foodHe.attemptedXSS()) {
                    output.innerHTML = "Nice try 😉";
                    submit.textContent = "Submit";
                    return;
                }

                output.innerHTML = "Building & Sending Submission Packet...";

                provideUsingDetails(name, [foodEn, foodEn_Sureness], [foodHe, foodHe_Sureness], foodWeight, foodCompanyObject, {value: glycemicIndex, metadata: glycemicIndex_Metadata}, {value: glycemicLoad, metadata: glycemicLoad_Metadata}, {value: sugar, metadata: sugar_Metadata}, {value: starch, metadata: starch_Metadata}, {value: fiber, metadata: fiber_Metadata}, {value: carbs, metadata: carbs_Metadata})
                    .then(response => {
                        output.innerHTML = response;
                        submit.textContent = "Submit";
                        // document.getElementById("food-name-english").value = "";
                        // document.getElementById("food-name-hebrew").value = "";
                        // document.getElementById("food-weight").value = "";
                        // document.getElementById("glycemic-index").value = "";
                        // document.getElementById("glycemic-load").value = "";
                        // document.getElementById("sugar").value = "";
                        // document.getElementById("carbs").value = "";
                        // document.getElementById("company").value = "";
                    })

            }   
        </script>

    </div>

    <script src="/js/foods/help-marks.js"></script>
    <script src="/js/foods/choice-buttons.js"></script>
    <script src="/js/foods/food-name-validator.js"></script>
    <script src="/js/foods/contribute.js"></script>

</body>

</html>